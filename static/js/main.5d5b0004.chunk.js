(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);n(27),n(28),n(29),n(30),n(31),n(32),n(33);var r=n(10),c=n(3),a=n(26),s=n(0),i=n.n(s),u=n(2),o=function(){return Object(u.jsx)(c.a,{})},l=n(14),b=n(8),d=n(4),j=n.n(d),p=n(6),f=n(5),m=n(12),h=n.n(m);function O(e,t){var n=Object(s.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return t}})),r=Object(f.a)(n,2),c=r[0],a=r[1];return[c,function(t){a(t),localStorage.setItem(e,JSON.stringify(t))}]}var x,v=i.a.createContext({user:null,setUser:function(){},inProcessing:[],setProcessingIDs:function(){}}),g=function(e){var t=e.children,n=O("user",null),r=Object(f.a)(n,2),c=r[0],a=r[1],i=Object(s.useState)([0]),o=Object(f.a)(i,2),l={user:c,setUser:a,inProcessing:o[0],setProcessingIDs:o[1]};return Object(u.jsx)(v.Provider,{value:l,children:t})},k=i.a.memo((function(e){var t=e.item,n=e.handleComplete,r=e.handleDelete,c=e.handleChangeTitle,a=Object(s.useState)(!1),i=Object(f.a)(a,2),o=i[0],l=i[1],b=Object(s.useState)(t.title),d=Object(f.a)(b,2),j=d[0],p=d[1],m=Object(s.useRef)(null),O=Object(s.useContext)(v).inProcessing.includes(t.id);Object(s.useEffect)((function(){m.current&&m.current.focus()}),[o]);return Object(u.jsxs)("div",{className:h()({"is-active":O},{editing:o},{completed:t.completed}),onDoubleClick:function(){return l(!0)},children:[O&&Object(u.jsx)("div",{className:"spinner"}),Object(u.jsxs)("div",{className:"view",children:[Object(u.jsx)("input",{type:"checkbox",className:"toggle",id:t.id.toString(),checked:t.completed,onChange:function(){return n(t.id,t.completed)}}),Object(u.jsx)("label",{htmlFor:"toggle-view",children:t.title}),Object(u.jsx)("button",{"aria-label":"button delete todo",type:"button",className:"destroy","data-cy":"deleteTodo",onClick:function(){return r(t.id)}})]}),Object(u.jsx)("input",{ref:m,type:"text",className:"edit",placeholder:"Empty todo will be deleted",value:j,onChange:function(e){return p(e.target.value)},onBlur:function(){c(t.id,j),l(!1)},onKeyDown:function(e){if("Escape"===e.key)return l(!1),void p(t.title);"Enter"===e.key&&(c(t.id,j),l(!1))}})]})})),N=i.a.memo((function(e){var t=e.items,n=e.handleComplete,r=e.handleCompleteAll,c=e.hasActiveTodos,a=e.handleDelete,s=e.handleChangeTitle;return Object(u.jsxs)("section",{className:"main",children:[Object(u.jsx)("input",{type:"checkbox",id:"toggle-all",className:"toggle-all","data-cy":"toggleAll",onChange:r,checked:c}),Object(u.jsx)("label",{htmlFor:"toggle-all",children:"Mark all as complete"}),Object(u.jsx)("ul",{className:"todo-list","data-cy":"todoList",children:t.map((function(e){return Object(u.jsx)("li",{children:Object(u.jsx)(k,{item:e,handleComplete:n,handleDelete:a,handleChangeTitle:s})},e.id)}))})]})})),y=i.a.memo((function(e){var t=e.error,n=e.errorNotice,r=e.closeErrorNotice;return Object(u.jsxs)("div",{className:h()("notification",{hidden:!t}),children:[Object(u.jsx)("button",{"aria-label":"btn",type:"button",className:"notification__delete",onClick:function(){return r("")}}),n]})}));!function(e){e.ALL="All",e.ACTIVE="Active",e.COMPLETED="Completed"}(x||(x={}));var C=[{link:"/",title:x.ALL},{link:"/active",title:x.ACTIVE},{link:"/completed",title:x.COMPLETED}],E=i.a.memo((function(){return Object(u.jsx)("ul",{className:"filters",children:C.map((function(e){return Object(u.jsx)("li",{children:Object(u.jsx)(r.c,{to:e.link,className:function(e){var t=e.isActive;return h()({selected:t})},children:e.title})},e.title)}))})})),w="https://mate.academy/students-api";function T(e){return new Promise((function(t){setTimeout(t,e)}))}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2?arguments[2]:void 0,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),T(300).then((function(){return fetch(w+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var _,S=function(e){return D(e)},A=function(e,t){return D(e,"POST",t)},I=function(e,t){return D(e,"PATCH",t)},P=function(e){return D(e,"DELETE")},L=function(e){return P("/todos/".concat(e))},U=function(e,t){return I("/todos/".concat(e),{completed:t})},M=function(e,t){return I("/todos/".concat(e),{title:t})};!function(e){e.LOADING="Unable loading data",e.ADD="Unable to add a todo",e.DELETE="Unable to delete a todo",e.UPDATE="Unable to update a todo",e.TITLE="Title can't be empty"}(_||(_={}));var J=function(){var e=O("todos",[]),t=Object(f.a)(e,2),n=t[0],a=t[1],i=Object(s.useState)(""),o=Object(f.a)(i,2),d=o[0],m=o[1],x=Object(s.useState)(""),g=Object(f.a)(x,2),k=g[0],C=g[1],w=Object(s.useState)(!1),T=Object(f.a)(w,2),D=T[0],I=T[1],P=Object(s.useState)(""),J=Object(f.a)(P,2),F=J[0],G=J[1],H=Object(c.m)().pathname,R=Object(s.useContext)(v),B=R.user,V=R.setUser,K=R.setProcessingIDs,W=!!F,Y=function(e){G(e)},q=Object(s.useCallback)(Object(p.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n=+B.id,S("/todos?userId=".concat(n));case 5:t=e.sent,a(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),Y(_.LOADING);case 12:case"end":return e.stop()}var n}),e,null,[[2,9]])}))),[B]);Object(s.useEffect)((function(){var e=setTimeout((function(){return G("")}),3e3);return function(){clearTimeout(e)}}),[F]),Object(s.useEffect)((function(){B&&q()}),[B]);var z=function(e){a([].concat(Object(b.a)(n),[e]))},Q=function(){var e=Object(p.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),K([0]),d.trim()){e.next=5;break}return Y(_.TITLE),e.abrupt("return");case 5:if(n={id:+new Date,title:d,completed:!1},!B){e.next=23;break}return z(n),n.id=0,n.userId=B.id,e.prev=10,e.next=13,A("/todos",n);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),Y(_.ADD);case 18:return e.prev=18,q(),e.finish(18);case 21:return m(""),e.abrupt("return");case 23:z(n),m("");case 25:case"end":return e.stop()}}),e,null,[[10,15,18,21]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(p.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,S("/users/".concat(k));case 4:n=e.sent,V(n),C(""),I(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Y(_.LOADING);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),Z=Object(s.useCallback)(function(){var e=Object(p.a)(j.a.mark((function e(t,r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K([t]),!B){e.next=13;break}return e.prev=2,e.next=5,U(t,!r);case 5:q(),K([]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),Y(_.UPDATE);case 12:return e.abrupt("return");case 13:a(n.map((function(e){return e.id!==t?e:Object(l.a)(Object(l.a)({},e),{},{completed:!e.completed})}))),K([]);case 15:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}(),[a]),$=Object(s.useCallback)(Object(p.a)(j.a.mark((function e(){var t,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.some((function(e){return!e.completed})),!B){e.next=14;break}return e.prev=2,r=n.map((function(e){return e.completed!==t?(K((function(t){return[].concat(Object(b.a)(t),[e.id])})),U(e.id,!e.completed)):e})),e.next=6,Promise.all(r);case 6:K([]),q(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),Y(_.UPDATE);case 13:return e.abrupt("return");case 14:a(n.map((function(e){return e.completed!==t?Object(l.a)(Object(l.a)({},e),{},{completed:!e.completed}):e})));case 15:case"end":return e.stop()}}),e,null,[[2,10]])}))),[a]),ee=Object(s.useCallback)(function(){var e=Object(p.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!B){e.next=13;break}return e.prev=1,K([t]),e.next=5,L(t);case 5:q(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Y(_.DELETE);case 11:return K([0]),e.abrupt("return");case 13:a(n.filter((function(e){return e.id!==t})));case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[a]),te=function(){var e=Object(p.a)(j.a.mark((function e(t){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!B){e.next=14;break}return e.prev=1,K(t),r=t.map((function(e){return L(e)})),e.next=6,Promise.all(r);case 6:q(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),Y(_.DELETE);case 12:return K([]),e.abrupt("return");case 14:a(n.filter((function(e){return!t.includes(e.id)})));case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),ne=Object(s.useCallback)(function(){var e=Object(p.a)(j.a.mark((function e(t,r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!B){e.next=19;break}if(e.prev=1,K([t]),r.trim()){e.next=9;break}return e.next=6,L(t);case 6:return K([]),q(),e.abrupt("return");case 9:return e.next=11,M(t,r);case 11:K([]),q(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),Y(_.UPDATE);case 18:return e.abrupt("return");case 19:if(r.trim()){e.next=22;break}return ee(t),e.abrupt("return");case 22:a(n.map((function(e){return e.id!==t?e:Object(l.a)(Object(l.a)({},e),{},{title:r})})));case 23:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t,n){return e.apply(this,arguments)}}(),[a]),re=Object(s.useMemo)((function(){return function(e,t){switch(t){case"/active":return e.filter((function(e){return!e.completed}));case"/completed":return e.filter((function(e){return e.completed}));default:return e}}(n,H)}),[n,H]),ce=Object(s.useMemo)((function(){return n.filter((function(e){return!e.completed}))}),[n]),ae=Object(s.useMemo)((function(){return n.filter((function(e){return e.completed}))}),[n]);return Object(u.jsxs)("div",{className:"container",children:[Object(u.jsxs)("div",{className:"todoapp",children:[Object(u.jsxs)("header",{className:"header",children:[Object(u.jsx)("h1",{children:"todos"}),Object(u.jsx)("form",{onSubmit:Q,children:Object(u.jsx)("input",{type:"text","data-cy":"createTodo",className:"new-todo",value:d,placeholder:B?"Hello ".concat(B.name,", what needs to be done?"):"What needs to be done?",onChange:function(e){var t=e.target;return m(t.value)}})})]}),n.length>0&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(N,{items:re,handleComplete:Z,handleCompleteAll:$,handleDelete:ee,handleChangeTitle:ne,hasActiveTodos:!ce.length}),Object(u.jsxs)("footer",{className:"footer",children:[Object(u.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(ce.length," items left")}),Object(u.jsx)(E,{}),ae.length>0&&Object(u.jsx)("button",{type:"button",className:"clear-completed",onClick:function(){return te(ae.map((function(e){return e.id})))},children:"Clear completed"})]})]}),Object(u.jsx)(r.b,{to:"/login",className:"item item__sign-up",children:"Sign up"}),Object(u.jsx)("button",{type:"button",className:"item item__sign-in",onClick:function(){if(B)return I(!1),void V(null);I(!D)},children:B?"Sign out":"Sign in"}),Object(u.jsx)("div",{className:h()("sign-in",{"show-form":!D}),children:Object(u.jsx)("form",{className:"sign-in__form",onSubmit:X,children:Object(u.jsx)("input",{className:"sign-in__input",placeholder:"ENTER USER ID",type:"number",value:k,onChange:function(e){var t=e.target;return C(t.value)}})})})]}),B&&Object(u.jsx)("h4",{children:"Your user ID ".concat(B.id)}),Object(u.jsx)(y,{error:W,errorNotice:F,closeErrorNotice:G})]})},F=function(){var e=Object(s.useState)(""),t=Object(f.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),i=Object(f.a)(a,2),o=i[0],l=i[1],b=Object(s.useState)(""),d=Object(f.a)(b,2),m=d[0],h=d[1],O=Object(s.useContext)(v),x=O.setUser,g=O.user,k=function(){var e=Object(p.a)(j.a.mark((function e(t){var r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(n.trim().length<4)){e.next=4;break}return h("name is too short"),e.abrupt("return");case 4:if(!(n.trim().length>20)){e.next=7;break}return h("name is too long"),e.abrupt("return");case 7:return r={id:0,name:n,email:o},e.prev=8,e.next=11,A("/users",r);case 11:a=e.sent,x(a),h("Sucsses, your ID ".concat(a.id)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),h("something went wrong");case 19:c(""),l("");case 21:case"end":return e.stop()}}),e,null,[[8,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{className:"sign-up__container",children:[Object(u.jsx)("h1",{className:"sign-up__title",children:"Sign up new user"}),Object(u.jsx)(r.b,{className:"sign-up__link",to:"/",children:"Home"}),g&&Object(u.jsx)("h1",{children:"Hello ".concat(g.name)}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{className:"sign-up__sub-title",children:"Sign Up"}),Object(u.jsx)("p",{className:"sign-up__notice",children:m}),Object(u.jsxs)("form",{className:"sign-up",onSubmit:k,children:[Object(u.jsx)("label",{className:"sign-up__label",children:Object(u.jsx)("input",{className:"sign-up__input",type:"text",placeholder:"Name min 4 symbols",value:n,onChange:function(e){var t=e.target;return c(t.value)}})}),Object(u.jsx)("label",{className:"sign-up__label",children:Object(u.jsx)("input",{className:"sign-up__input",type:"text",placeholder:"Email optionally",value:o,onChange:function(e){var t=e.target;return l(t.value)}})}),Object(u.jsx)("button",{type:"submit",className:"sign-up__button",children:"Submit"})]})]})]})};Object(a.createRoot)(document.getElementById("root")).render(Object(u.jsx)(r.a,{children:Object(u.jsx)(g,{children:Object(u.jsxs)(c.d,{children:[Object(u.jsx)(c.b,{path:"/",element:Object(u.jsx)(o,{})}),Object(u.jsx)(c.b,{index:!0,element:Object(u.jsx)(J,{})}),Object(u.jsx)(c.b,{path:"active",element:Object(u.jsx)(J,{})}),Object(u.jsx)(c.b,{path:"completed",element:Object(u.jsx)(J,{})}),Object(u.jsx)(c.b,{path:"/login",element:Object(u.jsx)(F,{})})]})})}))}},[[44,1,2]]]);
//# sourceMappingURL=main.5d5b0004.chunk.js.map